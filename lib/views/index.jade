extends layout

block content
  div#content
    div#mainHeader
      div#title
        span Pantry
        img.logo(src='img/logo_icon_alpha.png')
        span Pickup
    div#social
      <!-- AddThis Button BEGIN -->
      div.addthis_toolbox.addthis_default_style
        a.addthis_button_facebook_like(fb:like:layout='button_count')
        a.addthis_button_tweet
        a.addthis_button_pinterest_pinit
        a.addthis_counter.addthis_pill_style
      script.
        var addthis_config = {"data_track_addressbar":true};
      script(src='//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-51ab8b8269a4fc9b')
      <!-- AddThis Button END -->

    div#leftContainer
      div.searchIndicatorBar
        span
      div#filterWidget
        div#searchBar
          form.search(action='/search', method='GET')
            input#searchInput(type='text', name='term')
            select#searchRadius(name='radius')
              option(value='5') 5 Miles
              option 10
              option 25
              option 50
            input(type='submit', value='Submit')
        div#filterBar
      div#pantryList

    div#mapContainer
      div#mapView

    div#infoPanel
      div#locationInfo
      div#orgNeeds
        //To do in v2

    script(type="text/template", class="template", id="pantryListingTmpl").
      <h2><a class="name"><%- pantry.get('site_name') %></a></h2>
      <div class='address'>
        <div class='address1'><%- pantry.get('address') %></div>
        <div class='address2'><%- pantry.get('city') %>, MA <%- pantry.get('zipcode') %></div>
      </div>

    script#pantryDetailsTmpl.template(type="text/template")
      div.right
        a#detailClose X
      h2#siteName <%- pantry.get('site_name') %>
      | <% if (pantry.get('website') != '') { %>[<a href="<%- pantry.get('website') %>" target="_blank">link</a>]<% } %>
      address
        <%- pantry.get('address') %><br>
        <%- pantry.get('city') %>, MA <%- pantry.get('zipcode') %>
      div.phone <%- pantry.get('phone') %>
      div.source Source: <%- pantry.get('source') %>
      | <% if (pantry.get('hours').length > 0) { %>
      div.hours.
        Hours:<br>
        <% _(pantry.get('hours')).each(function(hours) { %>
          Open from <%- hours.start %> until <%- hours.end %>
          <%- hours.repeats %> on <%- hours.repeatsOn %><br>
        <% }); %>
      | <% } %>

      div.donations.
        Food donations accepted: <%- pantry.get('food_donations_accepted') ? 'Yes' : 'No' %><br>
        <%- pantry.get('volunteers_should_contact') ? 'Currently' : 'Not currently' %> looking for volunteers.

      div.needs.
        Food needs:
        <% if (pantry.get('food_needs').length) { %>
          <ul>
            <% _(pantry.get('food_needs')).each(function(need) { %>
              <li><%- need %></li>
            <% }); %>
          </ul>
        <% } else { %>
          None currently.
        <% } %>
      | <% if (pantry.get('cannot_accept').length) { %>
      div.cannot-accept.
        Can't accept:
        <ul>
          <% _(pantry.get('cannot_accept')).each(function(bad) { %>
            <li><%- bad %></li>
          <% }); %>
        </ul>
      | <% } %>

    script.
      window.pantries = !{JSON.stringify(pantries)}
